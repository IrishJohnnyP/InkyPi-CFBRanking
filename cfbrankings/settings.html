<div class="form-group">
  <label for="poll" class="form-label">Ranking source</label>
  <select class="form-select" id="poll" name="poll">
    <option value="auto">Auto (most recent available)</option>
    <option value="ap">AP Top 25</option>
    <option value="coaches">Coaches Poll</option>
    <option value="cfp">CFP (Selection Committee)</option>
  </select>
  <small class="form-text text-muted">All polls are selected from ESPN’s rankings feed; the plugin always chooses the <b>most recent</b> matching poll.</small>
</div>

<div class="form-group mt-3">
  <label for="top_n" class="form-label">List size (Top N)</label>
  <input class="form-control" type="number" id="top_n" name="top_n" min="1" max="25" value="20">
  <small class="form-text text-muted">1–25 (default 20)</small>
</div>

<div class="form-group mt-3">
  <label for="font_size" class="form-label">Font size</label>
  <select class="form-select" id="font_size" name="font_size">
    <option value="normal">Normal</option>
    <option value="large">Large</option>
    <option value="larger">Larger</option>
    <option value="largest">Largest</option>
  </select>
</div>

<div class="form-group mt-3">
  <label for="screen_size" class="form-label">Render size</label>
  <select class="form-select" id="screen_size" name="screen_size">
    <option value="auto">Auto (use device resolution)</option>
    <option value="800x480">800 × 480</option>
    <option value="1600x1200">1600 × 1200</option>
  </select>
</div>

<!-- Hidden inputs ensure the setting is saved even when the checkbox is unchecked -->
<input type="hidden" name="show_record" value="false" />
<div class="form-check mt-3">
  <input class="form-check-input" type="checkbox" id="show_record" name="show_record" value="true">
  <label class="form-check-label" for="show_record">Show record</label>
  <small class="form-text text-muted d-block">Records are automatically hidden when Top N &gt; 20 to prevent crowding.</small>
</div>

<input type="hidden" name="show_movement" value="false" />
<div class="form-check mt-2">
  <input class="form-check-input" type="checkbox" id="show_movement" name="show_movement" value="true">
  <label class="form-check-label" for="show_movement">Show movement (▲/▼ spots)</label>
</div>

<input type="hidden" name="show_nickname" value="false" />
<div class="form-check mt-2">
  <input class="form-check-input" type="checkbox" id="show_nickname" name="show_nickname" value="true">
  <label class="form-check-label" for="show_nickname">Show nickname (in parentheses)</label>
</div>

<input type="hidden" name="show_meta" value="false" />
<div class="form-check mt-2">
  <input class="form-check-input" type="checkbox" id="show_meta" name="show_meta" value="true">
  <label class="form-check-label" for="show_meta">Show season/week (if available)</label>
</div>

<div class="form-group mt-3">
  <label for="cache_minutes" class="form-label">Cache (minutes)</label>
  <input class="form-control" type="number" id="cache_minutes" name="cache_minutes" min="0" max="1440" value="30">
  <small class="form-text text-muted">0 disables caching.</small>
</div>

<script>
  function toBool(v, fallback=true) {
    if (v === undefined || v === null) return fallback;
    if (typeof v === 'boolean') return v;
    const s = String(v).toLowerCase().trim();
    if (['1','true','yes','on','checked'].includes(s)) return true;
    if (['0','false','no','off',''].includes(s)) return false;
    return fallback;
  }

  document.addEventListener('DOMContentLoaded', () => {
    if (typeof loadPluginSettings !== 'undefined') {
      document.getElementById('poll').value = pluginSettings.poll || 'auto';
      document.getElementById('top_n').value = pluginSettings.top_n || 20;
      document.getElementById('font_size').value = pluginSettings.font_size || 'normal';
      document.getElementById('screen_size').value = pluginSettings.screen_size || 'auto';

      document.getElementById('show_record').checked = toBool(pluginSettings.show_record, true);
      document.getElementById('show_movement').checked = toBool(pluginSettings.show_movement, true);
      document.getElementById('show_nickname').checked = toBool(pluginSettings.show_nickname, true);
      document.getElementById('show_meta').checked = toBool(pluginSettings.show_meta, true);

      document.getElementById('cache_minutes').value = pluginSettings.cache_minutes || 30;
    } else {
      document.getElementById('show_record').checked = true;
      document.getElementById('show_movement').checked = true;
      document.getElementById('show_nickname').checked = true;
      document.getElementById('show_meta').checked = true;
      document.getElementById('font_size').value = 'normal';
    }
  });
</script>
